var K=Object.create;var g=Object.defineProperty,q=Object.defineProperties,z=Object.getOwnPropertyDescriptor,G=Object.getOwnPropertyDescriptors,I=Object.getOwnPropertyNames,T=Object.getOwnPropertySymbols,J=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var L=(e,r,t)=>r in e?g(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,d=(e,r)=>{for(var t in r||(r={}))k.call(r,t)&&L(e,t,r[t]);if(T)for(var t of T(r))V.call(r,t)&&L(e,t,r[t]);return e},h=(e,r)=>q(e,G(r));var v=(e,r)=>{var t={};for(var o in e)k.call(e,o)&&r.indexOf(o)<0&&(t[o]=e[o]);if(e!=null&&T)for(var o of T(e))r.indexOf(o)<0&&V.call(e,o)&&(t[o]=e[o]);return t};var Q=(e,r)=>{for(var t in r)g(e,t,{get:r[t],enumerable:!0})},N=(e,r,t,o)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of I(r))!k.call(e,n)&&n!==t&&g(e,n,{get:()=>r[n],enumerable:!(o=z(r,n))||o.enumerable});return e};var U=(e,r,t)=>(t=e!=null?K(J(e)):{},N(r||!e||!e.__esModule?g(t,"default",{value:e,enumerable:!0}):t,e)),W=e=>N(g({},"__esModule",{value:!0}),e);var x=(e,r,t)=>new Promise((o,n)=>{var a=f=>{try{s(t.next(f))}catch(p){n(p)}},i=f=>{try{s(t.throw(f))}catch(p){n(p)}},s=f=>f.done?o(f.value):Promise.resolve(f.value).then(a,i);s((t=t.apply(e,r)).next())});var ne={};Q(ne,{ErrorMessage:()=>Z,Field:()=>$,FieldHOC:()=>ee,LessForm:()=>te,useField:()=>m,useFieldByContext:()=>Y,useForm:()=>oe});module.exports=W(ne);var l=U(require("react"));var b=require("react"),H=require("react-ob");function c(e,r){if(typeof r!="string")return;let t=r.split("."),o=e,n=t.length;try{for(let a=0;a<n;a++){let i=t[a];if(a<n-1)if(Array.isArray(o))if(/=/.test(i)){let[s,f]=i.split("=");o=o.find(p=>p[s]==f)}else isNaN(Number(i))||(o=o[Number(i)]);else o=o[i];else return o[i]}}catch(a){return}}function j(e,r,t){if(typeof r!="string")return;let o=r.split("."),n=e,a=o.length;try{for(let i=0;i<a;i++){let s=o[i];if(i<a-1)if(Array.isArray(n))if(/=/.test(s)){let[f,p]=s.split("=");n=n.find(u=>u[f]==p)}else isNaN(Number(s))||(n=n[Number(s)]);else n=n[s];else n[s]=t}}catch(i){}}var A=require("react"),F=(0,A.createContext)(void 0);var R={abortEarly:!1};function w(e){return!!e._blacklist}function _(a,i){return x(this,arguments,function*(e,r,{key:t,first:o,typeChange:n}={}){let s="",f="",p={};if(t)try{yield e.validateAt(t,r,R)}catch(u){u&&u.errors&&u.errors[0]&&(p[t]=u.errors[0],f=t,s=u.errors[0])}else{let u=Object.keys(r);try{yield e.isValid(r,R)}catch(y){p[y.path]=y.errors[0],f=y.path,s=y.errors[0]}}return{errors:p,error:s,path:f}})}function B(e,r){let t={};return Object.keys(e.touched).forEach(o=>{if(e.touched[o]){let n=r[o];n!==void 0&&(t[o]=n)}}),t}function C(t){return x(this,arguments,function*(e,r={}){if(e.validate){let o=yield Promise.resolve(e.validate(e.val,r.key));Object.assign(e.errors,B(e,o))}else if(e.validateSchema){let o=e.validateSchema,n;if(w(o)){let a={};Object.keys(o.fields).forEach(i=>{a[i]=c(e.val,i)}),n=yield _(o,a,h(d({},r),{typeChange:!0}))}else if(o.isSoke){let a={};o.schemaKeys.forEach(i=>{a[i]=c(e.val,i)}),n=o.validate(a,h(d({},r),{typeChange:!0})),console.log("__debug__",n)}r.key?e.errors[r.key]=n.error:e.errors=B(e,n.errors),n.error&&(e.error=n.error,e.errorPath=n.path)}e.next()})}var X={name:"",value:"",error:"",onChange:e=>{},onBlur:e=>{}};function Y(e,r,t){if(!e)return X;let o=(0,H.useObserver)(e,i=>t?t=="error"?[e.errors[r]]:[c(i,r)]:[c(i,r),e.errors[r]]);(0,b.useEffect)(()=>{let i=c(o,r);i!==void 0&&a.onChange(i)},[]);let n=c(o,r),a={name:r,value:n==null?"":n,error:typeof e.errors[r]=="undefined"?"":e.errors[r],onBlur:i=>{i.persist&&i.persist(),e.touched[r]||(e.touched[r]=!0,C(e,{first:!0,key:r,typeChange:!1}))},onChange:i=>{let s=typeof i,f;if(s==="undefined")f="";else if(s==="object"&&(i.currentTarget||i.target)){let y=i.currentTarget||i.target,S=y.type;if(S==="checkbox"||S==="radio")f=!!y.checked;else if(y.multiple){let P=y.options,E=[];for(var p=0,u=P.length;p<u;p++)P[p].selected&&E.push(P[p].value);f=E}else f=y.value}else f=i;j(e.val,r,f),e.handleChange&&(e.val=e.handleChange(e.val,r)),e.touched[r]?C(e,{first:!0,key:r,typeChange:!1}):e.next()}};return a}function m(e,r){let t=(0,b.useContext)(F);return Y(t,e,r)}function Z({name:e}){let r=m(e,"error");return l.createElement(l.Fragment,null,r.error)}function $({name:e,children:r,loadType:t}){let o=m(e,t);return r(o)}var M=require("react");function ee(e){return function(i){var s=i,{name:t,loadType:o,onChange:n}=s,a=v(s,["name","loadType","onChange"]);if(t){let f=m(t,o);return(0,M.useEffect)(()=>{n&&n(f.value)},[f.value]),l.createElement(e,d(d({},f),a))}return l.createElement(e,d({},a))}}var re=F.Provider;function te(n){var a=n,{children:e,onSubmit:r,value:t}=a,o=v(a,["children","onSubmit","value"]);return l.createElement(re,{value:t},l.createElement("form",d({onSubmit:i=>{i.preventDefault(),r&&r(i)}},o),e))}var O=require("react"),D=require("react-ob");function oe({initialValues:e,validate:r,validateSchema:t,handleChange:o}){let n=(0,O.useRef)((0,D.CreateObserver)(e));return(0,O.useMemo)(()=>{let a=Object.keys(e),i={};return a.forEach(s=>{i[s]=!1}),n.current=h(d({},n.current),{validate:r,isValid:(s={})=>(C(n.current,s),n.current.error),errors:{},error:"",touched:i,validateSchema:t,handleChange:o}),n.current},[])}
