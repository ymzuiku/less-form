var z=Object.create;var F=Object.defineProperty,G=Object.defineProperties,J=Object.getOwnPropertyDescriptor,Q=Object.getOwnPropertyDescriptors,U=Object.getOwnPropertyNames,k=Object.getOwnPropertySymbols,W=Object.getPrototypeOf,P=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var R=(e,r,t)=>r in e?F(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,y=(e,r)=>{for(var t in r||(r={}))P.call(r,t)&&R(e,t,r[t]);if(k)for(var t of k(r))A.call(r,t)&&R(e,t,r[t]);return e},j=(e,r)=>G(e,Q(r)),w=e=>F(e,"__esModule",{value:!0});var E=(e,r)=>{var t={};for(var n in e)P.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&k)for(var n of k(e))r.indexOf(n)<0&&A.call(e,n)&&(t[n]=e[n]);return t};var X=(e,r)=>{for(var t in r)F(e,t,{get:r[t],enumerable:!0})},d=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of U(r))!P.call(e,a)&&(t||a!=="default")&&F(e,a,{get:()=>r[a],enumerable:!(n=J(r,a))||n.enumerable});return e},Z=(e,r)=>d(w(F(e!=null?z(W(e)):{},"default",!r&&e&&e.__esModule?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e),$=(e=>(r,t)=>e&&e.get(r)||(t=d(w({}),r,1),e&&e.set(r,t),t))(typeof WeakMap!="undefined"?new WeakMap:0);var g=(e,r,t)=>new Promise((n,a)=>{var s=f=>{try{i(t.next(f))}catch(l){a(l)}},o=f=>{try{i(t.throw(f))}catch(l){a(l)}},i=f=>f.done?n(f.value):Promise.resolve(f.value).then(s,o);i((t=t.apply(e,r)).next())});var p={};X(p,{ErrorMessage:()=>re,Field:()=>te,FieldHOC:()=>oe,LessForm:()=>se,useField:()=>h,useFieldByContext:()=>Y,useFields:()=>ie,useFieldsByContext:()=>D,useForm:()=>ue});var u=Z(require("react"));d(p,require("soke"));var b=require("react"),K=require("react-ob");var B=require("react"),T=(0,B.createContext)(void 0);var H=require("soke");var M={abortEarly:!1};function x(e){return!!e._blacklist}function V(e,r,t){return g(this,null,function*(){let n={};if(t)try{yield e.validateAt(t,r,M)}catch(a){a&&a.errors&&a.errors[0]&&(n[t]=a.errors[0])}else{let a=Object.keys(r);for(let s of a)try{yield e.validateAt(s,r,M)}catch(o){o&&o.errors&&o.errors[0]&&(n[s]=o.errors[0])}}return n})}function O(e,r){if(e.entryValidateAll)return r;let t={};return Object.keys(e.touched).forEach(n=>{if(e.touched[n]){let a=r[n];a!==void 0&&(t[n]=a)}}),t}function S(e,r){return g(this,null,function*(){if(e.validate){let t=yield Promise.resolve(e.validate(e.val,r));Object.assign(e.errors,O(e,t))}else if(e.validateSchema)if(x(e.validateSchema)){let t=yield V(e.validateSchema,e.val,r);Object.assign(e.errors,O(e,t))}else{let t=(0,H.validateSoke)(e.validateSchema,e.val,r);Object.assign(e.errors,O(e,t))}e.next()})}var ee={name:"",value:"",error:"",onChange:e=>{},onBlur:e=>{}};function Y(e,r,t){if(!e)return ee;let n=(0,K.useObserver)(e,s=>t?t=="error"?[e.errors[r]]:[s[r]]:[s[r],e.errors[r]]);(0,b.useEffect)(()=>{e.val[r]&&a.onChange(e.val[r])},[]);let a={name:r,value:n[r]==null?"":n[r],error:typeof e.errors[r]=="undefined"?"":e.errors[r],onBlur:s=>{s.persist&&s.persist(),e.touched[r]||(e.touched[r]=!0,a.onChange(n[r]))},onChange:s=>{e.touched[r]||(e.touched[r]=!0);let o=typeof s,i;if(o==="undefined")i="";else if(o==="object"&&(s.currentTarget||s.target)){let c=s.currentTarget||s.target,m=c.type;if(m==="checkbox"||m==="radio")i=!!c.checked;else if(c.multiple){let C=c.options,L=[];for(var f=0,l=C.length;f<l;f++)C[f].selected&&L.push(C[f].value);i=L}else i=c.value}else i=s;e.val[r]=i,e.handleChange&&(e.val=e.handleChange(e.val,r)),S(e,r)}};return a}function h(e,r){let t=(0,b.useContext)(T);return Y(t,e,r)}function re({name:e}){let r=h(e,"error");return u.createElement(u.Fragment,null,r.error)}function te(n){var a=n,{name:e,children:r}=a,t=E(a,["name","children"]);let s=h(e);return u.createElement("input",y({name:e,value:s.value,onChange:s.onChange,onBlur:s.onBlur},t))}function oe(e,r){return function(s){var o=s,{name:n}=o,a=E(o,["name"]);if(n){let i=h(n,r);return u.createElement(e,y(y({},i),a))}return u.createElement(e,y({},a))}}var ne=T.Provider;function se(e){return u.createElement(ne,y({},e))}var I=require("react"),N=require("react-ob");var ae={names:[],values:{},errors:{},onChange:(e,r)=>{},keepValues:e=>{}};function D(e,r,t){if(!e)return ae;(0,N.useObserver)(e,s=>{let o=[];return t?t=="error"?(r.forEach(i=>{o.push(e.errors[i])}),o):(r.forEach(i=>{o.push(s[i])}),o):(r.forEach(i=>{o.push(s[i]),o.push(e.errors[i])}),o)});let n={},a={};return r.forEach(s=>{n[s]=e.val[s],a[s]=e.errors[s]||""}),{names:r,values:n,errors:a,onChange:(s,o)=>{e.val[s]=o,e.next()},keepValues:e.keepValues}}function ie(e,r){let t=(0,I.useContext)(T);return D(t,e,r)}var v=require("react"),_=require("react-ob"),q=require("soke");function ue({initialValues:e,initErrors:r,validate:t,entryValidateAll:n,validateSchema:a,handleChange:s}){let o=(0,v.useRef)((0,_.CreateObserver)(e));return(0,v.useEffect)(()=>{n&&o.current.validateAll&&o.current.validateAll()},[]),(0,v.useMemo)(()=>{let i=Object.keys(e),f={};return i.forEach(l=>{f[l]=!1}),o.current=j(y({},o.current),{validate:t,errors:r||{},fields:i,touched:f,entryCheckAll:!!n,validateSchema:a,findFirstError:()=>{if(!x(o.current.validateSchema))return(0,q.firstError)(o.current.validateSchema,o.current.errors);let l=o.current.fields,c="";return l.forEach(m=>{!c&&o.current.errors[m]&&(c=o.current.errors[m])}),c},validateAll:()=>g(this,null,function*(){return x(o.current.validateSchema)?o.current.fields.forEach(c=>{o.current.touched[c]=!0}):Object.keys(o.current.validateSchema).forEach(c=>{o.current.touched[c]=!0}),yield S(o.current),o.current.findFirstError()}),validateKey:l=>g(this,null,function*(){return o.current.touched[l]=!0,yield S(o.current,l),o.current.findFirstError()}),keepValues:l=>{let c=l||o.current.fields,m={};return c.forEach(C=>{m[C]=o.current.val[C]}),m},handleChange:s}),o.current},[])}module.exports=$(p);
