var R=Object.defineProperty,V=Object.defineProperties;var w=Object.getOwnPropertyDescriptors;var h=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var P=(e,r,t)=>r in e?R(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,d=(e,r)=>{for(var t in r||(r={}))O.call(r,t)&&P(e,t,r[t]);if(h)for(var t of h(r))k.call(r,t)&&P(e,t,r[t]);return e},g=(e,r)=>V(e,w(r));var C=(e,r)=>{var t={};for(var o in e)O.call(e,o)&&r.indexOf(o)<0&&(t[o]=e[o]);if(e!=null&&h)for(var o of h(e))r.indexOf(o)<0&&k.call(e,o)&&(t[o]=e[o]);return t};var T=(e,r,t)=>new Promise((o,i)=>{var a=s=>{try{f(t.next(s))}catch(p){i(p)}},n=s=>{try{f(t.throw(s))}catch(p){i(p)}},f=s=>s.done?o(s.value):Promise.resolve(s.value).then(a,n);f((t=t.apply(e,r)).next())});import*as l from"react";import{useContext as B,useEffect as H}from"react";import{useObserver as Y}from"react-ob";function c(e,r){if(typeof r!="string")return;let t=r.split("."),o=e,i=t.length;try{for(let a=0;a<i;a++){let n=t[a];if(a<i-1)if(Array.isArray(o))if(/=/.test(n)){let[f,s]=n.split("=");o=o.find(p=>p[f]==s)}else isNaN(Number(n))||(o=o[Number(n)]);else o=o[n];else return o[n]}}catch(a){return}}function S(e,r,t){if(typeof r!="string")return;let o=r.split("."),i=e,a=o.length;try{for(let n=0;n<a;n++){let f=o[n];if(n<a-1)if(Array.isArray(i))if(/=/.test(f)){let[s,p]=f.split("=");i=i.find(u=>u[s]==p)}else isNaN(Number(f))||(i=i[Number(f)]);else i=i[f];else i[f]=t}}catch(n){}}import{createContext as _}from"react";var v=_(void 0);var E={abortEarly:!1};function L(e){return!!e._blacklist}function N(a,n){return T(this,arguments,function*(e,r,{key:t,first:o,typeChange:i}={}){let f="",s="",p={};if(t)try{yield e.validateAt(t,r,E)}catch(u){u&&u.errors&&u.errors[0]&&(p[t]=u.errors[0],s=t,f=u.errors[0])}else{let u=Object.keys(r);try{yield e.isValid(r,E)}catch(y){p[y.path]=y.errors[0],s=y.path,f=y.errors[0]}}return{errors:p,error:f,path:s}})}function j(e,r){let t={};return Object.keys(e.touched).forEach(o=>{if(e.touched[o]){let i=r[o];i!==void 0&&(t[o]=i)}}),t}function A(t){return T(this,arguments,function*(e,r={}){if(e.validate){let o=yield Promise.resolve(e.validate(e.val,r.key));Object.assign(e.errors,j(e,o))}else if(e.validateSchema){let o=e.validateSchema,i;if(L(o)){let a={};Object.keys(o.fields).forEach(n=>{a[n]=c(e.val,n)}),i=yield N(o,a,g(d({},r),{typeChange:!0}))}else if(o.isSoke){let a={};o.schemaKeys.forEach(n=>{a[n]=c(e.val,n)}),i=o.validate(a,g(d({},r),{typeChange:!0})),console.log("__debug__",i)}r.key?e.errors[r.key]=i.error:e.errors=j(e,i.errors),i.error&&(e.error=i.error,e.errorPath=i.path)}e.next()})}var M={name:"",value:"",error:"",onChange:e=>{},onBlur:e=>{}};function D(e,r,t){if(!e)return M;let o=Y(e,n=>t?t=="error"?[e.errors[r]]:[c(n,r)]:[c(n,r),e.errors[r]]);H(()=>{let n=c(o,r);n!==void 0&&a.onChange(n)},[]);let i=c(o,r),a={name:r,value:i==null?"":i,error:typeof e.errors[r]=="undefined"?"":e.errors[r],onBlur:n=>{n.persist&&n.persist()},onChange:n=>{if(!e.touched[r]&&!n)return;n&&!e.touched[r]&&(e.touched[r]=!0);let f=typeof n,s;if(f==="undefined")s="";else if(f==="object"&&(n.currentTarget||n.target)){let y=n.currentTarget||n.target,F=y.type;if(F==="checkbox"||F==="radio")s=!!y.checked;else if(y.multiple){let x=y.options,b=[];for(var p=0,u=x.length;p<u;p++)x[p].selected&&b.push(x[p].value);s=b}else s=y.value}else s=n;S(e.val,r,s),e.handleChange&&(e.val=e.handleChange(e.val,r)),A(e,{first:!0,key:r,typeChange:!1})}};return a}function m(e,r){let t=B(v);return D(t,e,r)}function le({name:e}){let r=m(e,"error");return l.createElement(l.Fragment,null,r.error)}function ce({name:e,children:r,loadType:t}){let o=m(e,t);return r(o)}import{useEffect as K}from"react";function Te(e){return function(n){var f=n,{name:t,loadType:o,onChange:i}=f,a=C(f,["name","loadType","onChange"]);if(t){let s=m(t,o);return K(()=>{i&&i(s.value)},[s.value]),l.createElement(e,d(d({},s),a))}return l.createElement(e,d({},a))}}var q=v.Provider;function Fe(i){var a=i,{children:e,onSubmit:r,value:t}=a,o=C(a,["children","onSubmit","value"]);return l.createElement(q,{value:t},l.createElement("form",d({onSubmit:n=>{n.preventDefault(),r&&r(n)}},o),e))}import{useMemo as z,useRef as G}from"react";import{CreateObserver as I}from"react-ob";function Se({initialValues:e,validate:r,validateSchema:t,handleChange:o}){let i=G(I(e));return z(()=>{let a=Object.keys(e),n={};return a.forEach(f=>{n[f]=!1}),i.current=g(d({},i.current),{validate:r,errors:{},error:"",touched:n,validateSchema:t,handleChange:o}),i.current},[])}export{le as ErrorMessage,ce as Field,Te as FieldHOC,Fe as LessForm,m as useField,D as useFieldByContext,Se as useForm};
