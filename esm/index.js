var R=Object.defineProperty,B=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var F=(e,t,r)=>t in e?R(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g=(e,t)=>{for(var r in t||(t={}))k.call(t,r)&&F(e,r,t[r]);if(T)for(var r of T(t))A.call(t,r)&&F(e,r,t[r]);return e},O=(e,t)=>B(e,z(t));var C=(e,t)=>{var r={};for(var n in e)k.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&T)for(var n of T(e))t.indexOf(n)<0&&A.call(e,n)&&(r[n]=e[n]);return r};var h=(e,t,r)=>new Promise((n,s)=>{var a=u=>{try{i(r.next(u))}catch(f){s(f)}},o=u=>{try{i(r.throw(u))}catch(f){s(f)}},i=u=>u.done?n(u.value):Promise.resolve(u.value).then(a,o);i((r=r.apply(e,t)).next())});import*as c from"react";import{useContext as U,useEffect as W}from"react";import"react";import{useEffect as K,useMemo as ge,useRef as M,useState as H}from"react";var V=Object.defineProperty,E=Object.getOwnPropertySymbols,N=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable,q=(e,t,r)=>t in e?V(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,L=(e,t)=>{for(var r in t||(t={}))N.call(t,r)&&q(e,r,t[r]);if(E)for(var r of E(t))Z.call(t,r)&&q(e,r,t[r]);return e},J=typeof Element!="undefined",Y=typeof Map=="function",D=typeof Set=="function",X=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function v(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;let r,n,s;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(!v(e[n],t[n]))return!1;return!0}let a;if(Y&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(a=e.entries();!(n=a.next()).done;)if(!t.has(n.value[0]))return!1;for(a=e.entries();!(n=a.next()).done;)if(!v(n.value[1],t.get(n.value[0])))return!1;return!0}if(D&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(a=e.entries();!(n=a.next()).done;)if(!t.has(n.value[0]))return!1;return!0}if(X&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(e[n]!==t[n])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,s[n]))return!1;if(J&&e instanceof Element)return!1;for(n=r;n--!==0;)if(!((s[n]==="_owner"||s[n]==="__v"||s[n]==="__o")&&e.$$typeof)&&!v(e[s[n]],t[s[n]]))return!1;return!0}return e!==e&&t!==t}function G(e,t){try{return v(e,t)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}}function x(e,t){let[r,n]=H(e.val),s=M(t(e.val));return K(()=>{let a=()=>{let o=t(e.val),i=!G(o,s.current);s.current=o,i&&n(L({},e.val))};return e.subscribs.add(a),()=>{e.subscribs.delete(a)}},[]),r}function P(e){let t=new Set,r={subscribs:t,next:n=>{n?Promise.resolve(n(r.val)).then(()=>{t.forEach(s=>s())}):t.forEach(s=>s())},val:e};return r}import{createContext as Q}from"react";var y=Q(void 0);var pe={string:e=>S("string",e),array:e=>S("array",e),bool:e=>S("boolean",e),object:e=>S("object",e),number:e=>S("number",e)};function S(e,t){let r={__schemaItem:{errors:{matches:[]},matches:[]},required:n=>(r.__schemaItem.errors.required=n||"Need required",r.__schemaItem.requred=!0,r),matches:(n,s)=>(r.__schemaItem.errors.matches.push(s||"Matches error: "+String(n)),r.__schemaItem.matches.push(n),r),len:(n,s)=>(r.__schemaItem.errors.len=s||"Length no equal: "+n,r.__schemaItem.len=n,r),equal:(n,s)=>(r.__schemaItem.errors.equal=s||"Not equal the val",r.__schemaItem.equal=n,r),equalByKey:(n,s)=>(r.__schemaItem.errors.equalByKey=s||"Not equal by: "+n,r.__schemaItem.equalByKey=n,r),min:(n,s)=>(r.__schemaItem.errors.min=s||"Need min: "+n,r.__schemaItem.min=n,r),max:(n,s)=>(r.__schemaItem.errors.max=s||"Need max: "+n,r.__schemaItem.max=n,r),pick:(n,s)=>(r.__schemaItem.errors.pick=s||"Need in list: "+n,r.__schemaItem.pick=new Set(n),r),password:n=>(r.matches(/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/,n),r),passwordStrong:n=>(r.matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/,n),r),email:n=>(r.matches(/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,n),r),chinaPhone:n=>(r.matches(/^(?:(?:\+|00)86)?1\d{10}$/,n),r),chinaId:n=>(r.matches(/^[1-9]\d{5}(?:18|19|20)\d{2}(?:0[1-9]|10|11|12)(?:0[1-9]|[1-2]\d|30|31)\d{3}[\dXx]$/,n),r),url:n=>(r.matches(/^(((ht|f)tps?):\/\/)?([^!@#$%^&*?.\s-]([^!@#$%^&*?.\s]{0,63}[^!@#$%^&*?.\s])?\.)+[a-z]{2,6}\/?/,n),r),bank:n=>(r.matches(/^[1-9]\d{9,29}$/,n),r),chinaName:n=>(r.matches(/^(?:[\u4e00-\u9fa5·]{2,16})$/,n),r),chinaCar:n=>(r.matches(/^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领][A-HJ-NP-Z][A-HJ-NP-Z0-9]{4,5}[A-HJ-NP-Z0-9挂学警港澳]$/,n),r),hkId:n=>(r.matches(/^[a-zA-Z]\d{6}\([\dA]\)$/,n),r),number:n=>(r.matches(/^\d+$/,n),r),username:n=>(r.matches(/^[a-zA-Z0-9_-]{4,16}$/,n),r),letterOrNumber:n=>(r.matches(/^[A-Za-z0-9]+$/,n),r),letterAndNumber:n=>(r.matches(/^(?=.*[a-zA-Z])(?=.*\d).+$/,n),r),letter:n=>(r.matches(/^[a-zA-Z]+$/,n),r),uuid:n=>(r.matches(/^[a-f\d]{4}(?:[a-f\d]{4}-){4}[a-f\d]{12}$/i,n),r),integer:n=>(r.matches(/^-?[1-9]\d*$/,n),r),date:n=>(r.matches(/^\d{4}([/:-\S])(1[0-2]|0?[1-9])\1(0?[1-9]|[1-2]\d|30|31) (?:[01]\d|2[0-3]):[0-5]\d:[0-5]\d$/,n),r)};return r.__schemaItem.type=e,r.__schemaItem.errors.type=t||"Type not "+e,r}var I={type:(e,t)=>t===void 0||t==="array"&&Array.isArray(e)?!0:typeof e===t,min:(e,t)=>t===void 0?!0:typeof e=="number"?e>t:e&&e.length?e.length>t:!1,max:(e,t)=>t===void 0?!0:typeof e=="number"?e<t:e&&e.length?e.length<t:!1,pick:(e,t)=>t===void 0?!0:!(!e||Array.isArray(e)&&e.find(r=>!t.has(r))||!t.has(e))};function w(e,t,r){let n={},s=a=>{if(!e[a])return"";let o=e[a].__schemaItem,i=t[a];if(!I.type(i,o.type))return o.errors.type;if(o.requred&&!i)return o.errors.required;if(!I.min(i,o.min))return o.errors.min;if(!I.max(i,o.max))return o.errors.max;if(o.len&&typeof i=="string"&&i.length!==o.len)return o.errors.len;if(o.equal&&i!==o.equal)return o.errors.equal;if(o.equalByKey&&i!==t[o.equalByKey])return o.errors.equalByKey;if(!I.pick(i,o.pick))return o.errors.pick;if(o.matches.length){for(let u=0;u<o.matches.length;u++)if(!o.matches[u].test(i))return o.errors.matches[u]}return""};if(r)n[r]=s(r);else{let a=Object.keys(e);for(let o=0;o<a.length;o++){let i=a[o],u=s(i);if(n[i]=u,u)break}}return n}function be(e){let t=Object.keys(e),r="";for(let n=0;n<t.length;n++)if(t[n]){r=t[n];break}if(r)throw new Error(r)}var j={abortEarly:!1};function $(e,t,r){return h(this,null,function*(){let n={};if(r)try{yield e.validateAt(r,t,j)}catch(s){s&&s.errors&&s.errors[0]&&(n[r]=s.errors[0])}else{let s=Object.keys(t);for(let a of s)try{yield e.validateAt(a,t,j)}catch(o){o&&o.errors&&o.errors[0]&&(n[a]=o.errors[0])}}return n})}function _(e,t){if(e.entryValidateAll)return t;let r={};return Object.keys(e.touched).forEach(n=>{if(e.touched[n]){let s=t[n];s!==void 0&&(r[n]=s)}}),r}function p(e,t){return h(this,null,function*(){if(e.validate){let r=yield Promise.resolve(e.validate(e.val,t));Object.assign(e.errors,_(e,r))}else if(e.validateSchema)if(e.validateSchema._blacklist){let r=yield $(e.validateSchema,e.val,t);Object.assign(e.errors,_(e,r))}else{let r=w(e.validateSchema,e.val,t);Object.assign(e.errors,_(e,r))}e.next()})}var ee={name:"",value:"",error:"",onChange:e=>{},onBlur:e=>{}};function re(e,t,r){if(!e)return ee;let n=x(e,a=>r?r=="error"?[e.errors[t]]:[a[t]]:[a[t],e.errors[t]]);W(()=>{e.val[t]&&s.onChange(e.val[t])},[]);let s={name:t,value:n[t]==null?"":n[t],error:typeof e.errors[t]=="undefined"?"":e.errors[t],onBlur:a=>{a.persist&&a.persist(),e.touched[t]||(e.touched[t]=!0,s.onChange(n[t]))},onChange:a=>{e.touched[t]||(e.touched[t]=!0);let o=typeof a,i;if(o==="undefined")i="";else if(o==="object"&&a.currentTarget){let l=a.currentTarget.type;if(l==="checkbox"||l==="radio")i=!!a.currentTarget.checked;else if(a.currentTarget.multiple){let m=a.currentTarget.options,d=[];for(var u=0,f=m.length;u<f;u++)m[u].selected&&d.push(m[u].value);i=d}else i=a.currentTarget.value}else i=a;e.val[t]=i,e.handleChange&&(e.val=e.handleChange(e.val,t)),p(e,t)}};return s}function b(e,t){let r=U(y);return re(r,e,t)}function Ee({name:e}){let t=b(e,"error");return c.createElement(c.Fragment,null,t.error)}function we(n){var s=n,{name:e,children:t}=s,r=C(s,["name","children"]);let a=b(e);return c.createElement("input",g({name:e,value:a.value,onChange:a.onChange,onBlur:a.onBlur},r))}function Be(e,t){return function(a){var o=a,{name:n}=o,s=C(o,["name"]);if(n){let i=b(n,t);return c.createElement(e,g(g({},i),s))}return c.createElement(e,g({},s))}}var te=y.Provider;function Ne(e){return c.createElement(te,g({},e))}import{useContext as ne}from"react";var oe={names:[],values:{},errors:{},onChange:(e,t)=>{},contentValues:()=>{}};function se(e,t,r){if(!e)return oe;x(e,a=>{let o=[];return r?r=="error"?(t.forEach(i=>{o.push(e.errors[i])}),o):(t.forEach(i=>{o.push(a[i])}),o):(t.forEach(i=>{o.push(a[i]),o.push(e.errors[i])}),o)});let n={},s={};return t.forEach(a=>{n[a]=e.val[a],s[a]=e.errors[a]||""}),{names:t,values:n,errors:s,onChange:(a,o)=>{e.val[a]=o,e.next()},contentValues:e.contentValues}}function He(e,t){let r=ne(y);return se(r,e,t)}import{useEffect as ae,useMemo as ie,useRef as ue}from"react";function Qe({initialValues:e,initErrors:t,validate:r,entryValidateAll:n,validateSchema:s,handleChange:a}){let o=ue(P(e));return ae(()=>{n&&p(o.current)},[]),ie(()=>{let i=new Set(Object.keys(e)),u={};return i.forEach(f=>{u[f]=!1}),o.current=O(g({},o.current),{validate:r,errors:t||{},fields:i,touched:u,entryCheckAll:!!n,validateSchema:s,validateAll:()=>h(this,null,function*(){let f=o.current.fields;f.forEach(m=>{o.current.touched[m]=!0}),yield p(o.current);let l="";return f.forEach(m=>{!l&&o.current.errors[m]&&(l=o.current.errors[m])}),l}),validateKey:f=>h(this,null,function*(){let l=o.current.fields;l.forEach(d=>{o.current.touched[d]=!0}),yield p(o.current,f);let m="";return l.forEach(d=>{!m&&o.current.errors[d]&&(m=o.current.errors[d])}),m}),contentValues:()=>{let f=o.current.fields,l={};return f.forEach(m=>{l[m]=o.current.val[m]}),l},handleChange:a}),o.current},[])}export{Ee as ErrorMessage,we as Field,Be as FieldHOC,Ne as LessForm,pe as check,be as throwError,b as useField,re as useFieldByContext,He as useFields,se as useFieldsByContext,Qe as useForm,w as validateTiny};
