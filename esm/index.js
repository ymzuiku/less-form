var A=Object.defineProperty,R=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var E=(e,r,t)=>r in e?A(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,p=(e,r)=>{for(var t in r||(r={}))k.call(r,t)&&E(e,t,r[t]);if(T)for(var t of T(r))S.call(r,t)&&E(e,t,r[t]);return e},b=(e,r)=>R(e,j(r));var v=(e,r)=>{var t={};for(var s in e)k.call(e,s)&&r.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&T)for(var s of T(e))r.indexOf(s)<0&&S.call(e,s)&&(t[s]=e[s]);return t};var m=(e,r,t)=>new Promise((s,a)=>{var n=f=>{try{i(t.next(f))}catch(l){a(l)}},o=f=>{try{i(t.throw(f))}catch(l){a(l)}},i=f=>f.done?s(f.value):Promise.resolve(f.value).then(n,o);i((t=t.apply(e,r)).next())});import*as u from"react";import{useContext as B,useEffect as M}from"react";import{useObserver as V}from"react-ob";import{createContext as w}from"react";var g=w(void 0);var P={abortEarly:!1};function L(e){return!!e._blacklist}function O(e,r,t){return m(this,null,function*(){let s={};if(t)try{yield e.validateAt(t,r,P)}catch(a){a&&a.errors&&a.errors[0]&&(s[t]=a.errors[0])}else{let a=Object.keys(r);for(let n of a)try{yield e.validateAt(n,r,P)}catch(o){o&&o.errors&&o.errors[0]&&(s[n]=o.errors[0])}}return s})}function F(e,r){if(e.entryValidateAll)return r;let t={};return Object.keys(e.touched).forEach(s=>{if(e.touched[s]){let a=r[s];a!==void 0&&(t[s]=a)}}),t}function C(e,r){return m(this,null,function*(){if(e.validate){let t=yield Promise.resolve(e.validate(e.val,r));Object.assign(e.errors,F(e,t))}else if(e.validateSchema){if(L(e.validateSchema)){let t=yield O(e.validateSchema,e.val,r);Object.assign(e.errors,F(e,t))}else if(e.validateSchema.isSoke){let t=e.validateSchema.validate(e.val,r);Object.assign(e.errors,F(e,t))}}e.next()})}var H={name:"",value:"",error:"",onChange:e=>{},onBlur:e=>{}};function K(e,r,t){if(!e)return H;let s=V(e,n=>t?t=="error"?[e.errors[r]]:[n[r]]:[n[r],e.errors[r]]);M(()=>{e.val[r]&&a.onChange(e.val[r])},[]);let a={name:r,value:s[r]==null?"":s[r],error:typeof e.errors[r]=="undefined"?"":e.errors[r],onBlur:n=>{n.persist&&n.persist(),e.touched[r]||(e.touched[r]=!0,a.onChange(s[r]))},onChange:n=>{e.touched[r]||(e.touched[r]=!0);let o=typeof n,i;if(o==="undefined")i="";else if(o==="object"&&(n.currentTarget||n.target)){let c=n.currentTarget||n.target,d=c.type;if(d==="checkbox"||d==="radio")i=!!c.checked;else if(c.multiple){let y=c.options,x=[];for(var f=0,l=y.length;f<l;f++)y[f].selected&&x.push(y[f].value);i=x}else i=c.value}else i=n;e.val[r]=i,e.handleChange&&(e.val=e.handleChange(e.val,r)),C(e,r)}};return a}function h(e,r){let t=B(g);return K(t,e,r)}function ie({name:e}){let r=h(e,"error");return u.createElement(u.Fragment,null,r.error)}function fe(s){var a=s,{name:e,children:r}=a,t=v(a,["name","children"]);let n=h(e);return u.createElement("input",p({name:e,value:n.value,onChange:n.onChange,onBlur:n.onBlur},t))}function ye(e,r){return function(n){var o=n,{name:s}=o,a=v(o,["name"]);if(s){let i=h(s,r);return u.createElement(e,p(p({},i),a))}return u.createElement(e,p({},a))}}var Y=g.Provider;function he(e){return u.createElement(Y,p({},e))}import{useContext as I}from"react";import{useObserver as N}from"react-ob";var D={names:[],values:{},errors:{},onChange:(e,r)=>{},keepValues:e=>{}};function _(e,r,t){if(!e)return D;N(e,n=>{let o=[];return t?t=="error"?(r.forEach(i=>{o.push(e.errors[i])}),o):(r.forEach(i=>{o.push(n[i])}),o):(r.forEach(i=>{o.push(n[i]),o.push(e.errors[i])}),o)});let s={},a={};return r.forEach(n=>{s[n]=e.val[n],a[n]=e.errors[n]||""}),{names:r,values:s,errors:a,onChange:(n,o)=>{e.val[n]=o,e.next()},keepValues:e.keepValues}}function xe(e,r){let t=I(g);return _(t,e,r)}import{useEffect as q,useMemo as z,useRef as G}from"react";import{CreateObserver as J}from"react-ob";function Le({initialValues:e,initErrors:r,validate:t,entryValidateAll:s,validateSchema:a,handleChange:n}){let o=G(J(e));return q(()=>{s&&o.current.validateAll&&o.current.validateAll()},[]),z(()=>{let i=Object.keys(e),f={};return i.forEach(l=>{f[l]=!1}),o.current=b(p({},o.current),{validate:t,errors:r||{},fields:i,touched:f,entryCheckAll:!!s,validateSchema:a,findFirstError:()=>{let l=o.current.validateSchema;if(l.isSoke)return l.firstError(o.current.errors);let c=o.current.fields,d="";return c.forEach(y=>{!d&&o.current.errors[y]&&(d=o.current.errors[y])}),d},validateAll:()=>m(this,null,function*(){let l=o.current.validateSchema;return l.isSoke?l.schemaKeys.forEach(c=>{o.current.touched[c]=!0}):o.current.fields.forEach(d=>{o.current.touched[d]=!0}),yield C(o.current),o.current.findFirstError()}),validateKey:l=>m(this,null,function*(){return o.current.touched[l]=!0,yield C(o.current,l),o.current.findFirstError()}),keepValues:l=>{let c=l||o.current.fields,d={};return c.forEach(y=>{d[y]=o.current.val[y]}),d},handleChange:n}),o.current},[])}export{ie as ErrorMessage,fe as Field,ye as FieldHOC,he as LessForm,h as useField,K as useFieldByContext,xe as useFields,_ as useFieldsByContext,Le as useForm};
